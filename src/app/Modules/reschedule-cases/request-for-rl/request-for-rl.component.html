<div id="Kt-portlet-margin-top">
    <div class="kt-portlet">
      <!--[ngClass]="{ 'kt-portlet--body-progress' : viewLoading, 'kt-portlet--body-progress-overlay' : loadingAfterSubmit }"-->
      <div class="kt-portlet__head kt-portlet__head__custom" id="list-header">
        <div class="kt-portlet__head-label">
          <h3 class="kt-portlet__head-title">Request for Reschedulement of Loan Installment</h3>
        </div>
      </div>
    </div>
    
    <form [formGroup]="RfrlForm" class="kt-form kt-form--group-seperator-dashed">
        
        <div class="kt-form">
            
            <div class="kt-portlet__body">
                
                <div class="col-lg-11">
                    
                    <!-- <div class="col-lg-11">
                        <div class="kt-portlet__body-progress">
                            <mat-spinner [diameter]="2"></mat-spinner>
                          </div>
                          <kt-alert *ngIf="hasFormErrors" type="warn" [duration]="30000" [showCloseButton]="true" (close)="onAlertClose($event)">
                            Please enter valid Input
                          </kt-alert>
                    </div> -->

                    <div class="kt-portlet__body-progress">
                      <mat-spinner [diameter]="2"></mat-spinner>
                    </div>
                    <kt-alert *ngIf="hasFormErrors" type="warn" [duration]="30000" [showCloseButton]="true" (close)="onAlertClose($event)">
                      Please enter valid Input
                    </kt-alert>
                    
                    <div class="form-group kt-form__group row">

                        <div class="col-lg-3 kt-margin-bottom-20-mobile">
                            <mat-form-field class="mat-form-field-fluid" appearance="outline">
                              <mat-label class="customMatLabel">Zone <strong class="matMandatory">*</strong></mat-label>
                              <input matInput placeholder="Enter Zone" formControlName="Zone" readonly="readonly" maxlength="30" autocomplete="off" />
                              <!-- <mat-select formControlName="Zone">
                                <mat-option *ngFor="let zone of SelectedZones" [value]="zone.ZoneId">
                                  {{zone.ZoneName}}
                                </mat-option>
                              </mat-select> -->
                            </mat-form-field>
                        </div>

                        <div class="col-lg-3 kt-margin-bottom-20-mobile">
                            <mat-form-field class="mat-form-field-fluid" appearance="outline">
                              <mat-label class="customMatLabel">Branch <strong class="matMandatory">*</strong></mat-label>
                              <input matInput placeholder="Enter Zone" formControlName="Branch" readonly="readonly" maxlength="30" autocomplete="off" />
                              <!-- <mat-select formControlName="Branch">
                                <mat-option *ngFor="let branch of SelectedBranches" [value]="branch.BranchId">
                                  {{branch.Name}}
                                </mat-option>                                
                              </mat-select> -->
                            </mat-form-field>
                        </div>

                    </div>
                    
                    <div class="form-group kt-form__group row">

                        <div class="col-lg-3 kt-margin-bottom-20-mobile">
                            <mat-form-field class="mat-form-field-fluid" appearance="outline">
                              <mat-label class="customMatLabel">Cnic <strong class="matMandatory">*</strong></mat-label>
                              <input matInput placeholder="Enter Cnic" formControlName="Cnic"  maxlength="13" autocomplete="off" appNumberOnly/>
                              <mat-error *ngIf="hasError('Cnic', 'required')">Cnic <strong>required</strong></mat-error>
                            </mat-form-field>
                        </div>
                        <div class="col-lg-3 kt-margin-bottom-20-mobile">
                          <mat-form-field class="mat-form-field-fluid" appearance="outline">
                            <mat-label class="customMatLabel">Application Date(ddMMyyyy) <strong class="matMandatory">*</strong></mat-label>
                            <input readonly="readonly" matInput [matDatepicker]="picker3" formControlName="EffectiveReqDate" [max]="today">
                            <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
                            <mat-datepicker #picker3></mat-datepicker>
                            <!--<mat-error *ngIf="hasError('AppDate', 'required')">Application Date <strong>required</strong></mat-error>-->
                          </mat-form-field>
                        </div>
                        <!-- <div class="col-lg-3 kt-margin-bottom-20-mobile">
                            <mat-form-field class="mat-form-field-fluid" appearance="outline">
                              <mat-label class="customMatLabel">Application Date(ddMMyyyy) <strong class="matMandatory">*</strong></mat-label>
                              <input matInput placeholder="Enter Application Date" formControlName="EffectiveReqDate"  maxlength="10" autocomplete="off"/>
                            </mat-form-field>
                        </div> -->

                    </div>

                    <div class="form-group kt-form__group row">

                        <div class="col-lg-3 kt-margin-bottom-20-mobile">
                            <mat-form-field class="mat-form-field-fluid" appearance="outline">
                              <mat-label class="customMatLabel">Branch Remarks<strong class="matMandatory">*</strong></mat-label>
                              <input matInput placeholder="Enter Branch Remarks" formControlName="Remarks" autocomplete="off"/>
                            </mat-form-field>
                        </div>

                        <div class="col-lg-3 kt-margin-bottom-20-mobile">
                          <mat-form-field class="mat-form-field-fluid" appearance="outline">
                            <mat-label class="customMatLabel">Request Category <strong class="matMandatory">*</strong></mat-label>
                            <mat-select (selectionChange)="onSelectionChange($event)" formControlName="RequestCategory">

                              <mat-option *ngFor="let Request of SelectedRequestType" [value]="Request.Id">
                                {{Request.Name}}
                              </mat-option>                                
                            </mat-select>
                          </mat-form-field>
                      </div>

                      <div class="col-lg-3 kt-margin-bottom-20-mobile" *ngIf="graceMonthsSelect">
                        <mat-form-field class="mat-form-field-fluid" appearance="outline">
                          <mat-label class="customMatLabel">Grace Months <strong class="matMandatory">*</strong></mat-label>
                          <mat-select formControlName="GraceMonths">
                              <mat-option *ngFor="let slct of select" [value]="slct.value">
                                {{slct.viewValue}}
                              </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    </div>

                    <div class="form-group kt-form__group row">

                        <div class="col-lg-3 kt-margin-bottom-20-mobile">
                            <mat-form-field class="mat-form-field-fluid" appearance="outline">
                              <mat-label class="customMatLabel">Manager PPNO <strong class="matMandatory">*</strong></mat-label>
                              <input matInput placeholder="Enter Manager PPNO" formControlName="MPpno"  appNumberOnly autocomplete="off" />
                            </mat-form-field>
                        </div>

                    </div>

                </div>

            </div>
        </div>
        

    </form>

    <div class="col-lg-12">
      <div class="form-group kt-form__group">
        <button mat-raised-button color="primary" (click)="find()">Find</button>
      </div>
  </div>

    <div class="col-lg-12" *ngIf="Field">
      <mat-form-field class="mat-form-field-fluid" appearance="outline">
        <mat-label class="customMatLabel"><em>No Record Found</em></mat-label>
        <input matInput placeholder="No Record Found" autocomplete="off" readonly="readonly" />
      </mat-form-field>
    </div>

    <div class="col-lg-12" *ngIf="Field">
      <mat-form-field class="mat-form-field-fluid" appearance="outline">
        <mat-label class="customMatLabel"><em>No Record Found</em></mat-label>
        <input matInput placeholder="No Record Found" autocomplete="off" readonly="readonly" />
      </mat-form-field>
    </div>

    <div class="col-lg-12">

      <table class="table table-striped " *ngIf="Table">
        <thead>
          <tr class="table-header-background">
            <th>LC#</th>
            <th>Cnic</th>
            <th>Customer Name</th>
            <th>Father Name</th>
            <th>GL Description</th>
            <th>AGPS</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let res of response; let i = index;">
            <td>{{res.LoanCaseNo}}</td>
            <td>{{res.Cnic}}</td>
            <td>{{res.CustomerName}}</td>
            <td>{{res.FatherName}}</td>
            <td>{{res.GlSubname}}</td>
            <td>{{res.MajorBorrower}}</td>
            <td><mat-checkbox (change)="onChange(res, $event, i)" [(ngModel)]="checked"></mat-checkbox></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="Table" class="d-flex justify-content-center">
      <button mat-raised-button color="primary" (click)="Add()">Add Select Record</button>
    </div>
    
    <div class="col-lg-12 mt-2">

      <table class="table table-striped " *ngIf="AddTable && checkedArr.length>0">
        <thead>
          <tr class="table-header-background">
            <th>LC#</th>
            <th>Cnic</th>
            <th>Customer Name</th>
            <th>Father Name</th>
            <th>GL Description</th>
            <th>AGPS</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let res of tableArr; let i = index;">
            <td>{{res.LoanCaseNo}}</td>
            <td>{{res.Cnic}}</td>
            <td>{{res.CustomerName}}</td>
            <td>{{res.FatherName}}</td>
            <td>{{res.GlSubname}}</td>
            <td>{{res.MajorBorrower}}</td>
            <td><button mat-raised-button color="primary" (click)="deleteRow(i)" >Delete</button></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="AddTable && checkedArr.length>0" class="d-flex justify-content-center" >
      <button mat-raised-button color="primary" (click)="submitData()" >Submit</button>
      <button class="ml-2" mat-raised-button color="primary" (click)="cancelData()" >Cancel</button>
    </div>

</div>
    
<kt-spinner></kt-spinner>
    
    <!-- <ngx-spinner bdColor="rgba(51,51,51,0.8)"
                 size="medium"
                 color="#ecbd00"
                 type="ball-scale-multiple">
      <p style="font-size: 20px; color: white">Loading...</p>
    </ngx-spinner> -->